<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating the prevalence of wasting ‚Ä¢ mwana</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="prevalence_files/libs/quarto-html/popper.min.js"></script><script src="prevalence_files/libs/quarto-html/tippy.umd.min.js"></script><link href="prevalence_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="prevalence_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the prevalence of wasting">
<meta property="og:image" content="https://nutriverse.io/mwana/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-success" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mwana</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/plausibility.html">Running plausibility checks</a></li>
    <li><a class="dropdown-item" href="../articles/prevalence.html">Estimating the prevalence of wasting</a></li>
    <li><a class="dropdown-item" href="../articles/ipc_amn_check.html">IPC sample size requirements</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://nutriverse.io"><span class="fa globe fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mastodon.social/@nutriverse"><span class="fa fab fa-mastodon fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nutriverse/mwana/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1></h1>

      <p class="author">Tom√°s Zaba</p>


      <small class="dont-index">Source: <a href="https://github.com/nutriverse/mwana/blob/v0.2.1/vignettes/prevalence.qmd" class="external-link"><code>vignettes/prevalence.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <header id="title-block-header" class="quarto-title-block"><h1 class="title">Estimating the prevalence of wasting</h1></header><section class="section level3"><h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This vignette demonstrates how to use the <code>mwana</code> package‚Äôs functions to estimate the prevalence of wasting. The package allow users to estimate prevalence based on:</p>
<ul>
<li>Weight-for-height z-score (WFHZ) and/or edema;</li>
<li>Raw MUAC values and/or edema;</li>
<li>MUAC-for-age z-score (MFAZ) and/or edema, and</li>
<li>Combined prevalence.</li>
</ul>
<p>The prevalence functions in <code>mwana</code> were carefully conceived and designed to simplify the workflow of a nutrition data analyst, especially when dealing with data sets containing imperfections that require additional layers of analysis. Let‚Äôs try to clarify this with two scenarios that I believe will remind you of the complexity involved:</p>
<ul>
<li><p>When analysing a multi-area data set, users will likely need to estimate the prevalence for each area individually. Afterward, they must extract the results and collate in a summary table to share.</p></li>
<li><p>When working with MUAC data, if age ratio test is rated as problematic, an additional tool is required to weight the prevalence and correct for age bias, thus the associated likely overestimation of the prevalence. In unfortunate cases where multiple areas face this issue, the workflow must be repeated several times, making the process cumbersome and highly error-prone üò¨.</p></li>
</ul>
<p>With <code>mwana</code> you no longer have to worry about this ü•≥ as the functions are designed to deal with that. To demonstrate their use, we will use different data sets containing some imperfections alluded above:</p>
<ul>
<li>
<code>anthro.02</code> : a survey data with survey weights. Read more about this data with <code><a href="../reference/anthro.02.html">?anthro.02</a></code>.</li>
<li>
<code>anthro.03</code> : district-level SMART surveys with two districts whose WFHZ standard deviations are rated as problematic while the rest are within range. Do <code><a href="../reference/anthro.03.html">?anthro.03</a></code> for more details.</li>
<li>
<code>anthro.04</code> : a community-based sentinel site data. The data has different characteristics that require different analysis approaches.</li>
</ul>
<p>Now we can begin delving into each function.</p>
<section class="level3"><h4 id="sec-prevalence-wfhz">Estimation of the prevalence of wasting based on WFHZ<a class="anchor" aria-label="anchor" href="#sec-prevalence-wfhz"></a>
</h4>
<p>To estimate the prevalence of wasting based on WFHZ we use the <code><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz()</a></code> function. The data set to supply must have been wrangled by <code><a href="../reference/mw_wrangle_wfhz.html">mw_wrangle_wfhz()</a></code>.</p>
<p>As usual, we start off by inspecting our data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">anthro.02</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 6 √ó 14</span></span>
<span><span class="co">#&gt;   province strata cluster   sex   age weight height edema  muac wtfactor   wfhz</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Nampula  Urban      285     1  59.5   13.8   90.7 n       149     487.  0.689</span></span>
<span><span class="co">#&gt; 2 Nampula  Rural      234     1  59.5   17.2  105.  n       193    1045.  0.178</span></span>
<span><span class="co">#&gt; 3 Nampula  Rural      263     1  59.6   18.4  100   n       156     952.  2.13</span></span>
<span><span class="co">#&gt; 4 Nampula  Rural      257     1  59.7   15.9  100.  n       149     987.  0.353</span></span>
<span><span class="co">#&gt; 5 Nampula  Rural      239     1  59.8   12.5   91.5 n       135     663. -0.722</span></span>
<span><span class="co">#&gt; 6 Nampula  Rural      263     1  60.0   14.3   93.8 n       142     952.  0.463</span></span>
<span><span class="co">#&gt; # ‚Ñπ 3 more variables: flag_wfhz &lt;dbl&gt;, mfaz &lt;dbl&gt;, flag_mfaz &lt;dbl&gt;</span></span></code></pre>
</div>
<p>We can see that the data set contains the required variables for a WFHZ prevalence analysis, including for a weighted analysis. This data set has already been wrangled, so we do not need to call the WFHZ wrangler in this case. We will begin the demonstration with an unweigthed analysis - typical of SMART surveys - and then we proceed to a weighted analysis.</p>
<section class="level4"><h5 id="estimation-of-unweighted-prevalence">Estimation of unweighted prevalence<a class="anchor" aria-label="anchor" href="#estimation-of-unweighted-prevalence"></a>
</h5>
<p>To achieve this we do:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.02</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>This will return:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 1 √ó 16</span></span>
<span><span class="co">#&gt;   gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n   sam_p sam_p_low sam_p_upp</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   121 0.0408    0.0322    0.0494        Inf    43 0.00664   0.00273    0.0106</span></span>
<span><span class="co">#&gt; # ‚Ñπ 7 more variables: sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;, mam_p &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;, wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>If for some reason the variable edema is not available in the data set, or it‚Äôs there but not plausible, we can exclude it from the analysis by setting the argument <code>edema</code> to <code>NULL</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.02</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Setting edema to NULL</span></span>
<span>    .by <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>And we get:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 1 √ó 16</span></span>
<span><span class="co">#&gt;   gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n sam_p sam_p_low sam_p_upp</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   107 0.0342    0.0263    0.0420        Inf    29     0         0         0</span></span>
<span><span class="co">#&gt; # ‚Ñπ 7 more variables: sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;, mam_p &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;, wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>If we inspect the <code>gam_n</code> and <code>gam_p</code> columns of this output table and the previous, we notice differences in the numbers. This occurs because edema cases were excluded in the second implementation. Note that you will observed a change if there are positive cases of edema in the data set; otherwise, setting <code>edema = NULL</code> will have no effect whatsoever.</p>
<p>The above output summary does not show results by province. We can control that using the <code>.by</code> argument. In the above examples, it was set to <code>NULL</code>; now let‚Äôs pass the name of the column containing the locations where the data was collected. In our case, the column is <code>province</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.02</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">province</span> <span class="co"># province is the variable's name holding data on where the survey was conducted.</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>And <em>voila</em> :</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 2 √ó 17</span></span>
<span><span class="co">#&gt;   province gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n   sam_p sam_p_low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Zambezia    41 0.0290    0.0195    0.0384        Inf    10 0.00351 0.0000639</span></span>
<span><span class="co">#&gt; 2 Nampula     80 0.0546    0.0397    0.0695        Inf    33 0.0103  0.00282</span></span>
<span><span class="co">#&gt; # ‚Ñπ 8 more variables: sam_p_upp &lt;dbl&gt;, sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p &lt;dbl&gt;, mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>A table with two rows is returned with each province‚Äôs statistics.</p>
</section><section class="level4"><h5 id="estimation-of-weighted-prevalence">Estimation of weighted prevalence<a class="anchor" aria-label="anchor" href="#estimation-of-weighted-prevalence"></a>
</h5>
<p>To get the weighted prevalence, we make the use of the <code>wt</code> argument. We pass to it the column name containing the final survey weights. In our case, the column name is <code>wtfactor</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.02</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="va">wtfactor</span>, <span class="co"># Passing the wtfactor to wt</span></span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">province</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>And you get:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 2 √ó 17</span></span>
<span><span class="co">#&gt;   province gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n   sam_p sam_p_low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Zambezia    41 0.0261    0.0161    0.0361       1.16    10 0.00236 -0.000255</span></span>
<span><span class="co">#&gt; 2 Nampula     80 0.0595    0.0410    0.0779       1.52    33 0.0129   0.00272</span></span>
<span><span class="co">#&gt; # ‚Ñπ 8 more variables: sam_p_upp &lt;dbl&gt;, sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p &lt;dbl&gt;, mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<div>
<blockquote>
<p><strong>The work under the hood of <code>mw_estimate_prevalence_wfhz</code></strong></p>
<p>Under the hood, before starting the prevalence estimation, the function first checks the quality of the WFHZ standard deviation. If it is not rated as problematic, it proceeds with a complex sample-based analysis; otherwise, prevalence is estimated applying the PROBIT method. This is as you see in the body of the plausibility report generated by ENA. The <code>anthro.02</code> data set has no such issues, so you don‚Äôt see <code>mw_estimate_prevalence_wfhz</code> in action on this regard. To see that, let‚Äôs use the <code>anthro.03</code> data set.</p>
</blockquote>
</div>
<p><code>anthro.03</code> contains problematic standard deviation in Metuge and Maravia districts, while the remaining districts are within range.</p>
<p>Let‚Äôs inspect our data set:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 6 √ó 9</span></span>
<span><span class="co">#&gt;   district cluster  team sex     age weight height edema  muac</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Metuge         2     2 m      9.99   10.1   69.3 n       172</span></span>
<span><span class="co">#&gt; 2 Metuge         2     2 f     43.6    10.9   91.5 n       130</span></span>
<span><span class="co">#&gt; 3 Metuge         2     2 f     32.8    11.4   91.4 n       153</span></span>
<span><span class="co">#&gt; 4 Metuge         2     2 f      7.62    8.3   69.5 n       133</span></span>
<span><span class="co">#&gt; 5 Metuge         2     2 m     28.4    10.7   82.3 n       143</span></span>
<span><span class="co">#&gt; 6 Metuge         2     2 f     12.3     6.6   69.4 n       121</span></span></code></pre>
</div>
<p>Now let‚Äôs apply the prevalence function. This is data is not wrangled, so we will have to wrangle it before passing to the prevalence function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.03</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_wfhz.html">mw_wrangle_wfhz</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    height <span class="op">=</span> <span class="va">height</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">weight</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_wfhz.html">mw_estimate_prevalence_wfhz</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">district</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>The returned output will be:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; # A tibble: 4 √ó 17</span></span>
<span><span class="co">#&gt;   district   gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n   sam_p sam_p_low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Metuge        NA 0.0251   NA        NA              NA    NA 0.00155  NA</span></span>
<span><span class="co">#&gt; 2 Cahora-Ba‚Ä¶    25 0.0738    0.0348    0.113         Inf     4 0.00336  -0.00348</span></span>
<span><span class="co">#&gt; 3 Chiuta        11 0.0444    0.0129    0.0759        Inf     2 0.00444  -0.00466</span></span>
<span><span class="co">#&gt; 4 Maravia       NA 0.0450   NA        NA              NA    NA 0.00351  NA</span></span>
<span><span class="co">#&gt; # ‚Ñπ 8 more variables: sam_p_upp &lt;dbl&gt;, sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p &lt;dbl&gt;, mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>Can you spot the differences? üòé Yes, you‚Äôre absolutely correct! While in Cahora-Bassa and Chi√∫ta districts all columns are populated with numbers, in Metuge and Maravia, only the <code>gam_p</code>, <code>sam_p</code> and <code>mam_p</code> columns are filled with numbers, and everything else with <code>NA</code>. These are district where the PROBIT method was applied, while in Cahora-Bassa and Chi√∫ta ditricts the standard complex sample analysis was done.</p>
</section></section><section class="level3"><h4 id="estimation-of-the-prevalence-of-wasting-based-on-mfaz">Estimation of the prevalence of wasting based on MFAZ<a class="anchor" aria-label="anchor" href="#estimation-of-the-prevalence-of-wasting-based-on-mfaz"></a>
</h4>
<p>The prevalence of wasting based on MFAZ can be estimated using the <code><a href="../reference/mw_estimate_prevalence_mfaz.html">mw_estimate_prevalence_mfaz()</a></code> function. This function works and is implemented the same way as demonstrated in <a href="#sec-prevalence-wfhz" class="quarto-xref">Section¬†1.1</a>, with the exception of the data wrangling that is based on MUAC. This was demonstrated in the <a href="https://nutriverse.io/mwana/articles/plausibility.html">plausibility checks</a>. In this way, to avoid redundancy, we will not demonstrate the workflow.</p>
</section><section class="level3"><h4 id="sec-prevalence-muac">Estimation of the prevalence of wasting based on raw MUAC values<a class="anchor" aria-label="anchor" href="#sec-prevalence-muac"></a>
</h4>
<p>This job is assigned to <code><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac()</a></code>. Once you call the function, before starting the prevalence estimation, it first evaluates the acceptability of the MFAZ standard deviation and the age ratio test. Yes, you read well, MFAZ‚Äôs standard deviation, not on the raw values MUAC.</p>
<div>
<blockquote>
<p><strong>Important</strong></p>
<p>Although the acceptability is evaluated on the basis of MFAZ, the actual prevalence is estimated on the basis of the raw MUAC values. MFAZ is also used to detect outliers and flag them to be excluded from the prevalence analysis.</p>
</blockquote>
</div>
<p>The MFAZ standard deviation and the age ratio test results are used to control the prevalence analysis flow in this way:</p>
<ul>
<li>If the MFAZ standard deviation and the age ratio test are both not problematic, a standard complex sample-based prevalence is estimated.</li>
<li>If the MFAZ standard deviation is not problematic but the age ratio test is problematic, the SMART MUAC tool age-weighting approach is applied.</li>
<li>If the MFAZ standard deviation is problematic, even if age ratio is not problematic, no prevalence analysis is estimated, instead <code>NA</code> are thrown.</li>
</ul>
<p>When working with a multiple-area data set, these conditionals will still be applied according to each area‚Äôs situation.</p>
<div>
<blockquote>
<p><strong>How does it work on a multi-area data set</strong></p>
<p>Fundamentally, the function performs the standard deviation and age ratio tests, evaluates their acceptability, and returns a summarized table by area. It then iterates over that summary table row by row checking the above conditionals. Based on the conditionals of each row (area), the function accesses the original data set, computes the prevalence accordingly, and returns the results.</p>
</blockquote>
</div>
<p>To demonstrate this we will use the <code>anthro.04</code> data set.</p>
<p>As usual, let‚Äôs first inspect it:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 6 √ó 8</span></span>
<span><span class="co">#&gt;   province   cluster   sex   age  muac edema   mfaz flag_mfaz</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Province 3     743     2    21   130 n     -1.50          0</span></span>
<span><span class="co">#&gt; 2 Province 3     743     2     9   126 n     -1.33          0</span></span>
<span><span class="co">#&gt; 3 Province 3     743     2    12   128 n     -1.27          0</span></span>
<span><span class="co">#&gt; 4 Province 3     743     2    34   145 n     -0.839         0</span></span>
<span><span class="co">#&gt; 5 Province 3     743     2    11   130 n     -1.04          0</span></span>
<span><span class="co">#&gt; 6 Province 3     743     2    33   140 n     -1.23          0</span></span></code></pre>
</div>
<p>You see that this data has already been wrangled, so we will go straight to the prevalence estimation.</p>
<div>
<blockquote>
<p><strong>Important</strong></p>
<p>As in ENA Software, make sure you run the plausibility check before you call the prevalence function. This is good to know about the acceptability of your data. If we do that with <code>anthro.04</code> we will see which province has issues, hence what we should be expecting to see in below demonstrations based on the conditionals stated above.</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.04</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">province</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>This will return:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 3 √ó 17</span></span>
<span><span class="co">#&gt;   province   gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n   sam_p sam_p_low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Province 1   135  0.104    0.0778     0.130        Inf    19  0.0133   0.00682</span></span>
<span><span class="co">#&gt; 2 Province 2    NA  0.112   NA         NA             NA    NA  0.0201  NA</span></span>
<span><span class="co">#&gt; 3 Province 3    NA NA       NA         NA             NA    NA NA       NA</span></span>
<span><span class="co">#&gt; # ‚Ñπ 8 more variables: sam_p_upp &lt;dbl&gt;, sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p &lt;dbl&gt;, mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>We see that in Province 1, all columns are filled with numbers; in Province 2, some columns are filled with numbers, while other columns are filled with <code>NA</code>s: this is where the age-weighting approach was applied. Lastly, in Province 3 a bunch of <code>NA</code> are filled everywhere - you know why üòâ .</p>
<p>Alternatively, we can choose to apply the function that calculates the age-weighted prevalence estimates inside <code><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac()</a></code> directly on to our data set. This can be done by calling the <code><a href="../reference/prev_muac.html">mw_estimate_smart_age_wt()</a></code> function. It worth noting that although possible, we recommend to use the main function. This is simply due the fact that if we decide to use the function independently, then we must, before calling it, check the acceptability of the standard deviation of MFAZ and of the age ratio test, and then evaluate if the conditions that fits the use <code><a href="../reference/prev_muac.html">mw_estimate_smart_age_wt()</a></code> are there. We would have to do that ourselves. This introduces some kind of cumbersomeness in the workflow, and along with that, a risk of picking a wrong analysis workflow.</p>
<p>Nonetheless, if for any reason we decide to go for it anyway, then we would apply the function as demonstrated below. We will continue using the <code>anthro.04</code> data set. For this demonstration, we will just pull out the data set from <code>Province 2</code> where we already know that the conditions to apply <code><a href="../reference/prev_muac.html">mw_estimate_smart_age_wt()</a></code> are met, and then we will pipe it in to the function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.04</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">province</span> <span class="op">==</span> <span class="st">"Province 2"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/prev_muac.html">mw_estimate_smart_age_wt</a></span><span class="op">(</span></span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>This returns the following:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 1 √ó 3</span></span>
<span><span class="co">#&gt;    sam_p  mam_p gam_p</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 0.0201 0.0922 0.112</span></span></code></pre>
</div>
<section class="level4"><h5 id="estimation-of-weighted-prevalence-1">Estimation of weighted prevalence<a class="anchor" aria-label="anchor" href="#estimation-of-weighted-prevalence-1"></a>
</h5>
<p>For this we go back <code>anthro.02</code> data set.</p>
<p>We approach this task as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load library ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Compute prevalence ----</span></span>
<span><span class="va">anthro.02</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_age.html">mw_wrangle_age</a></span><span class="op">(</span></span>
<span>    age <span class="op">=</span> <span class="va">age</span>,</span>
<span>    .decimals <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_muac.html">mw_wrangle_muac</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    muac <span class="op">=</span> <span class="va">muac</span>,</span>
<span>    .recode_muac <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    .to <span class="op">=</span> <span class="st">"cm"</span>,</span>
<span>    age <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    muac <span class="op">=</span> <span class="fu"><a href="../reference/recode_muac.html">recode_muac</a></span><span class="op">(</span><span class="va">muac</span>, .to <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="va">wtfactor</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">province</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>This will return:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; # A tibble: 2 √ó 17</span></span>
<span><span class="co">#&gt;   province gam_n  gam_p gam_p_low gam_p_upp gam_p_deff sam_n  sam_p sam_p_low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Nampula     70 0.0571    0.0369    0.0773       2.00    28 0.0196   0.00706</span></span>
<span><span class="co">#&gt; 2 Zambezia    65 0.0552    0.0380    0.0725       1.67    18 0.0133   0.00412</span></span>
<span><span class="co">#&gt; # ‚Ñπ 8 more variables: sam_p_upp &lt;dbl&gt;, sam_p_deff &lt;dbl&gt;, mam_n &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   mam_p &lt;dbl&gt;, mam_p_low &lt;dbl&gt;, mam_p_upp &lt;dbl&gt;, mam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<div>
<blockquote>
<p><strong>Warning</strong></p>
<p>You may have noticed that in the above code block, we called the <code><a href="../reference/recode_muac.html">recode_muac()</a></code> function inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>. This is because after you use <code><a href="../reference/mw_wrangle_muac.html">mw_wrangle_muac()</a></code>, it puts the MUAC variable in centimeters. The <code><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac()</a></code> function was defined to accept MUAC in millimeters. Therefore, it must be converted to millimeters.</p>
</blockquote>
</div>
</section><section class="level4"><h5 id="estimation-for-non-survey-data">Estimation for non survey data<a class="anchor" aria-label="anchor" href="#estimation-for-non-survey-data"></a>
</h5>
<p>Thus far, the demonstration has been around survey data. However, it is also common in day-to-day practice to come across non survey data to analyse. Non survey data can be screenings or any other kind of community-based surveillance data. With this kind of data, the analysis workflow usually consists in a simple estimation of the point prevalence and the counts of the positive cases, without necessarily estimating the uncertainty. <code>mwana</code> provides a handy function for this task: <code><a href="../reference/mw_estimate_prevalence_screening.html">mw_estimate_prevalence_screening()</a></code>. Under the hood, this function works exactly the same way as <code><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac()</a></code>. The only difference is that it was designed to deal with non survey data.</p>
<p>To demonstrate its usage, we will use the <code>anthro.04</code> data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anthro.04</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_screening.html">mw_estimate_prevalence_screening</a></span><span class="op">(</span></span>
<span>    muac <span class="op">=</span> <span class="va">muac</span>, </span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>, </span>
<span>    .by <span class="op">=</span> <span class="va">province</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>The returned output is:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 3 √ó 7</span></span>
<span><span class="co">#&gt;   province   gam_n  gam_p sam_n   sam_p mam_n   mam_p</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Province 1   133  0.104    17  0.0133   116  0.0908</span></span>
<span><span class="co">#&gt; 2 Province 2    NA  0.112    NA  0.0201    NA  0.0922</span></span>
<span><span class="co">#&gt; 3 Province 3    NA NA        NA NA         NA NA</span></span></code></pre>
</div>
</section></section><section class="level3"><h4 id="estimation-of-the-combined-prevalence-of-wasting">Estimation of the combined prevalence of wasting<a class="anchor" aria-label="anchor" href="#estimation-of-the-combined-prevalence-of-wasting"></a>
</h4>
<p>The estimation of the combined prevalence of wasting is a task attributed to the <code><a href="../reference/mw_estimate_prevalence_combined.html">mw_estimate_prevalence_combined()</a></code> function. The case-definition is based on the WFHZ, the raw MUAC values and edema. From the workflow standpoint, it combines the workflow demonstrated in <a href="#sec-prevalence-wfhz" class="quarto-xref">Section¬†1.1</a> and in <a href="#sec-prevalence-muac" class="quarto-xref">Section¬†1.3</a>.</p>
<p>To demonstrate it‚Äôs implementation we will use the <code>anthro.01</code> data set.</p>
<p>Let‚Äôs inspect the data:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; # A tibble: 6 √ó 11</span></span>
<span><span class="co">#&gt;   area       dos        cluster  team sex   dob      age weight height edema</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;date&gt;       &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;date&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 District E 2023-12-04       1     3 m     NA        59   15.6  109.  n</span></span>
<span><span class="co">#&gt; 2 District E 2023-12-04       1     3 m     NA         8    7.5   68.6 n</span></span>
<span><span class="co">#&gt; 3 District E 2023-12-04       1     3 m     NA        19    9.7   79.5 n</span></span>
<span><span class="co">#&gt; 4 District E 2023-12-04       1     3 f     NA        49   14.3  100.  n</span></span>
<span><span class="co">#&gt; 5 District E 2023-12-04       1     3 f     NA        32   12.4   92.1 n</span></span>
<span><span class="co">#&gt; 6 District E 2023-12-04       1     3 f     NA        17    9.3   77.8 n</span></span>
<span><span class="co">#&gt; # ‚Ñπ 1 more variable: muac &lt;int&gt;</span></span></code></pre>
</div>
<section class="level4"><h5 id="data-wrangling">Data wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h5>
<p>Fundamentally, it combines the data wrangling workflow of WFHZ and MUAC:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load library ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Apply the wrangling workflow ----</span></span>
<span><span class="va">anthro.01</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_age.html">mw_wrangle_age</a></span><span class="op">(</span></span>
<span>    dos <span class="op">=</span> <span class="va">dos</span>,</span>
<span>    dob <span class="op">=</span> <span class="va">dob</span>,</span>
<span>    age <span class="op">=</span> <span class="va">age</span>,</span>
<span>    .decimals <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_muac.html">mw_wrangle_muac</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    muac <span class="op">=</span> <span class="va">muac</span>,</span>
<span>    .recode_muac <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    .to <span class="op">=</span> <span class="st">"cm"</span>,</span>
<span>    age <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    muac <span class="op">=</span> <span class="fu"><a href="../reference/recode_muac.html">recode_muac</a></span><span class="op">(</span><span class="va">muac</span>, .to <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_wfhz.html">mw_wrangle_wfhz</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">weight</span>,</span>
<span>    height <span class="op">=</span> <span class="va">height</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>This is to get the <code>wfhz</code> and <code>flag_wfhz</code> the <code>mfaz</code> and <code>flag_mfaz</code> added to the data set. In the output below, we have just selected these columns:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; # A tibble: 1,191 √ó 5</span></span>
<span><span class="co">#&gt;    area         wfhz flag_wfhz   mfaz flag_mfaz</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 District E -1.83          0 -1.45          0</span></span>
<span><span class="co">#&gt;  2 District E -0.956         0 -1.67          0</span></span>
<span><span class="co">#&gt;  3 District E -0.796         0 -0.617         0</span></span>
<span><span class="co">#&gt;  4 District E -0.74          0 -1.02          0</span></span>
<span><span class="co">#&gt;  5 District E -0.679         0 -0.93          0</span></span>
<span><span class="co">#&gt;  6 District E -0.432         0 -1.10          0</span></span>
<span><span class="co">#&gt;  7 District E -0.078         0 -0.255         0</span></span>
<span><span class="co">#&gt;  8 District E -0.212         0 -0.677         0</span></span>
<span><span class="co">#&gt;  9 District E -1.07          0 -2.18          0</span></span>
<span><span class="co">#&gt; 10 District E -0.543         0 -0.403         0</span></span>
<span><span class="co">#&gt; # ‚Ñπ 1,181 more rows</span></span></code></pre>
</div>
<p>Under the hood, <code><a href="../reference/mw_estimate_prevalence_combined.html">mw_estimate_prevalence_combined()</a></code> applies the same analysis approach as in <code>mw_estimate_prevalence_wfhz</code> and in <code><a href="../reference/prev_muac.html">mw_estimate_prevalence_muac()</a></code>. It checks the acceptability of the standard deviation of WFHZ and MFAZ and of the age ratio test. The following conditionals are checked and applied:</p>
<ul>
<li>If the standard deviation of WFHZ and of MFAZ, and the age ratio test are all concurrently not problematic, the standard complex sample-based estimation is applied.</li>
<li>If any of the above is rated problematic, the prevalence is not computed and <code>NA</code>s are thrown.</li>
</ul>
<p>In this function, a concept of ‚Äúcombined flags‚Äù is used.</p>
<div>
<blockquote>
<p><strong>What is combined flag?</strong></p>
<p>Combined flags consists of defining as flag any observation that is flagged in either <code>flag_wfhz</code> or <code>flag_mfaz</code> vectors. A new column <code>cflags</code> for combined flags is created and added to the data set. This ensures that all flagged observations from both WFHZ and MFAZ data are excluded from the prevalence analysis.</p>
</blockquote>
</div>
<div id="tbl-table-1" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table¬†1: A glimpse of case-definition of combined flag
</figcaption><div aria-describedby="tbl-table-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table caption-top">
<thead><tr class="header">
<th style="text-align: center;"><strong>flag_wfhz</strong></th>
<th style="text-align: center;"><strong>flag_mfaz</strong></th>
<th style="text-align: center;"><strong>cflags</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Now that we understand what happens under the hood, we can now proceed to implement it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load library ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Apply the workflow ----</span></span>
<span><span class="va">anthro.01</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_age.html">mw_wrangle_age</a></span><span class="op">(</span></span>
<span>    dos <span class="op">=</span> <span class="va">dos</span>,</span>
<span>    dob <span class="op">=</span> <span class="va">dob</span>,</span>
<span>    age <span class="op">=</span> <span class="va">age</span>,</span>
<span>    .decimals <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_muac.html">mw_wrangle_muac</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    muac <span class="op">=</span> <span class="va">muac</span>,</span>
<span>    .recode_muac <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"cm"</span>,</span>
<span>    .to <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    muac <span class="op">=</span> <span class="fu"><a href="../reference/recode_muac.html">recode_muac</a></span><span class="op">(</span><span class="va">muac</span>, .to <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_wrangle_wfhz.html">mw_wrangle_wfhz</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">weight</span>,</span>
<span>    height <span class="op">=</span> <span class="va">height</span>,</span>
<span>    .recode_sex <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mw_estimate_prevalence_combined.html">mw_estimate_prevalence_combined</a></span><span class="op">(</span></span>
<span>    wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    edema <span class="op">=</span> <span class="va">edema</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">area</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>We get this:</p>
<div class="cell">
<pre><code><span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; # A tibble: 2 √ó 17</span></span>
<span><span class="co">#&gt;   area       cgam_n  cgam_p cgam_p_low cgam_p_upp cgam_p_deff csam_n   csam_p</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 District E     NA NA         NA         NA               NA     NA NA</span></span>
<span><span class="co">#&gt; 2 District G     55  0.0703     0.0447     0.0958         Inf     13  0.00747</span></span>
<span><span class="co">#&gt; # ‚Ñπ 9 more variables: csam_p_low &lt;dbl&gt;, csam_p_upp &lt;dbl&gt;, csam_p_deff &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cmam_n &lt;dbl&gt;, cmam_p &lt;dbl&gt;, cmam_p_low &lt;dbl&gt;, cmam_p_upp &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cmam_p_deff &lt;dbl&gt;, wt_pop &lt;dbl&gt;</span></span></code></pre>
</div>
<p>In district E <code>NA</code>s were returned because there were issues with the data. I leave it to you to figure out what was/were the issue/issues.</p>
<div>
<blockquote>
<p><strong>Tip</strong></p>
<p>Consider running the plausibility checkers.</p>
</blockquote>
</div>
</section></section></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tom√°s Zaba, Ernest Guevarra.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
