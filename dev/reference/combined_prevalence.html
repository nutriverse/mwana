<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute combined prevalence of wasting — compute_pps_based_combined_prevalence • mwana</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute combined prevalence of wasting — compute_pps_based_combined_prevalence"><meta name="description" content="The prevalence is calculated in accordance with the complex sample design
properties inherent to surveys. This includes weighting of survey data where
applicable. When either the acceptability of the standard deviation of WFHZ or
of the age ratio test is problematic, prevalence is not calculated."><meta property="og:description" content="The prevalence is calculated in accordance with the complex sample design
properties inherent to surveys. This includes weighting of survey data where
applicable. When either the acceptability of the standard deviation of WFHZ or
of the age ratio test is problematic, prevalence is not calculated."><meta property="og:image" content="https://nutriverse.io/mwana/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-success" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mwana</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/plausibility.html">Running plausibility checks</a></li>
    <li><a class="dropdown-item" href="../articles/prevalence.html">Estimating the prevalence of wasting</a></li>
    <li><a class="dropdown-item" href="../articles/ipc_amn_check.html">Checking if IPC Acute Malnutrition sample size requirements were met</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://nutriverse.io"><span class="fa globe fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mastodon.social/@nutriverse"><span class="fa fab fa-mastodon fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nutriverse/mwana/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute combined prevalence of wasting</h1>
      <small class="dont-index">Source: <a href="https://github.com/nutriverse/mwana/blob/main/R/prevalence_combined.R" class="external-link"><code>R/prevalence_combined.R</code></a></small>
      <div class="d-none name"><code>combined_prevalence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The prevalence is calculated in accordance with the complex sample design
properties inherent to surveys. This includes weighting of survey data where
applicable. When either the acceptability of the standard deviation of WFHZ or
of the age ratio test is problematic, prevalence is not calculated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_pps_based_combined_prevalence</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  .wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .edema <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">.summary_by</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compute_combined_prevalence</span><span class="op">(</span><span class="va">df</span>, .wt <span class="op">=</span> <span class="cn">NULL</span>, .edema <span class="op">=</span> <span class="cn">NULL</span>, .summary_by <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>An already wrangled dataset of class <code>data.frame</code> to use. Both
wranglers (of WFHZ and of MUAC) need to be used sequentially, regardless of the
order. Note that MUAC values should be converted to millimeters after using
the MUAC wrangler.</p></dd>


<dt id="arg--wt">.wt<a class="anchor" aria-label="anchor" href="#arg--wt"></a></dt>
<dd><p>A vector of class <code>double</code> of the final survey weights. Default is
<code>NULL</code> assuming a self-weighted survey, as in the ENA for SMART software;
otherwise a weighted analysis is computed.</p></dd>


<dt id="arg--edema">.edema<a class="anchor" aria-label="anchor" href="#arg--edema"></a></dt>
<dd><p>A vector of class <code>character</code> of edema. Code should be
"y" for presence and "n" for absence of bilateral edema. Default is <code>NULL</code>.</p></dd>


<dt id="arg--summary-by">.summary_by<a class="anchor" aria-label="anchor" href="#arg--summary-by"></a></dt>
<dd><p>A vector of class <code>character</code> of the geographical areas
where the data was collected and for which the analysis should be performed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A summarised table of class <code>data.frame</code> for the descriptive
statistics about combined wasting.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A concept of "combined flags" is introduced in this function. It consists of
defining as flag any observation that is flagged in either <code>flag_wfhz</code> or
<code>flag_mfaz</code> vectors. A new column <code>cflags</code> for combined flags is created and
added to <code>df</code>. This ensures that all flagged observations from both WFHZ
and MFAZ data are excluded from the combined prevalence analysis.</p>
<p><em>The table below shows an overview of how <code>cflags</code> are defined</em></p><table class="table table"><tr><td><strong>flag_wfhz</strong></td><td><strong>flag_mfaz</strong></td><td><strong>cflags</strong></td></tr><tr><td>1</td><td>0</td><td>1</td></tr><tr><td>0</td><td>1</td><td>1</td></tr><tr><td>0</td><td>0</td><td>0</td></tr></table></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## When .summary_by and .wt are set to NULL ----</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">compute_combined_prevalence</span><span class="op">(</span></span></span>
<span class="r-in"><span>df <span class="op">=</span> <span class="va">anthro.02</span>,</span></span>
<span class="r-in"><span>.wt <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>.edema <span class="op">=</span> <span class="va">edema</span>,</span></span>
<span class="r-in"><span>.summary_by <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 16</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cgam_n cgam_p cgam_p_low cgam_p_upp cgam_p_deff csam_n csam_p csam_p_low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    199 0.068<span style="text-decoration: underline;">5</span>     0.056<span style="text-decoration: underline;">6</span>     0.080<span style="text-decoration: underline;">4</span>         <span style="color: #BB0000;">Inf</span>     68 0.012<span style="text-decoration: underline;">9</span>    0.007<span style="text-decoration: underline;">70</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: csam_p_upp &lt;dbl&gt;, csam_p_deff &lt;dbl&gt;, cmam_n &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   cmam_p &lt;dbl&gt;, cmam_p_low &lt;dbl&gt;, cmam_p_upp &lt;dbl&gt;, cmam_p_deff &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   wt_pop &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## When .wt is not set to NULL ----</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">compute_combined_prevalence</span><span class="op">(</span></span></span>
<span class="r-in"><span>df <span class="op">=</span> <span class="va">anthro.02</span>,</span></span>
<span class="r-in"><span>.wt <span class="op">=</span> <span class="st">"wtfactor"</span>,</span></span>
<span class="r-in"><span>.edema <span class="op">=</span> <span class="va">edema</span>,</span></span>
<span class="r-in"><span>.summary_by <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 16</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cgam_n cgam_p cgam_p_low cgam_p_upp cgam_p_deff csam_n csam_p csam_p_low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    199 0.070<span style="text-decoration: underline;">8</span>     0.056<span style="text-decoration: underline;">3</span>     0.085<span style="text-decoration: underline;">3</span>        1.72     68 0.015<span style="text-decoration: underline;">1</span>    0.007<span style="text-decoration: underline;">50</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: csam_p_upp &lt;dbl&gt;, csam_p_deff &lt;dbl&gt;, cmam_n &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   cmam_p &lt;dbl&gt;, cmam_p_low &lt;dbl&gt;, cmam_p_upp &lt;dbl&gt;, cmam_p_deff &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   wt_pop &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## When working on data frame with multiple survey areas ----</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="va">anthro.03</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mw_wrangle_age.html">mw_wrangle_age</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>dos <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>dob <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>age <span class="op">=</span> <span class="va">age</span>,</span></span>
<span class="r-in"><span>.decimals <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mw_wrangle_muac.html">mw_wrangle_muac</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>muac <span class="op">=</span> <span class="va">muac</span>,</span></span>
<span class="r-in"><span>age <span class="op">=</span> <span class="st">"age"</span>,</span></span>
<span class="r-in"><span>.recode_sex <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>.recode_muac <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>.to <span class="op">=</span> <span class="st">"cm"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>muac <span class="op">=</span> <span class="fu"><a href="recode_muac.html">recode_muac</a></span><span class="op">(</span><span class="va">muac</span>, .to <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mw_wrangle_wfhz.html">mw_wrangle_wfhz</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>weight <span class="op">=</span> <span class="va">weight</span>,</span></span>
<span class="r-in"><span>height <span class="op">=</span> <span class="va">height</span>,</span></span>
<span class="r-in"><span>.recode_sex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">compute_combined_prevalence</span><span class="op">(</span></span></span>
<span class="r-in"><span>.edema <span class="op">=</span> <span class="va">edema</span>,</span></span>
<span class="r-in"><span>.summary_by <span class="op">=</span> <span class="va">district</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   district     cgam_n  cgam_p cgam_p_low cgam_p_upp cgam_p_deff csam_n   csam_p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Metuge           15  0.053<span style="text-decoration: underline;">8</span>    0.011<span style="text-decoration: underline;">9</span>      0.095<span style="text-decoration: underline;">6</span>         <span style="color: #BB0000;">Inf</span>      6  0.005<span style="text-decoration: underline;">38</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Cahora-Bassa     27  0.083<span style="text-decoration: underline;">6</span>    0.049<span style="text-decoration: underline;">3</span>      0.118          <span style="color: #BB0000;">Inf</span>      2  0      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Chiuta           11  0.035<span style="text-decoration: underline;">9</span>    0.007<span style="text-decoration: underline;">01</span>     0.064<span style="text-decoration: underline;">7</span>         <span style="color: #BB0000;">Inf</span>      4  0.004<span style="text-decoration: underline;">48</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Maravia          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 9 more variables: csam_p_low &lt;dbl&gt;, csam_p_upp &lt;dbl&gt;, csam_p_deff &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   cmam_n &lt;dbl&gt;, cmam_p &lt;dbl&gt;, cmam_p_low &lt;dbl&gt;, cmam_p_upp &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   cmam_p_deff &lt;dbl&gt;, wt_pop &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomás Zaba, Ernest Guevarra.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

